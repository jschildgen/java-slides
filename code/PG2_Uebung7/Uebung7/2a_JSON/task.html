<html>
<p>Als weiteres benötigen wir eine Möglichkeit, JSON-Daten zu parsen, damit wir später in der Witze-App auf das Ergebnis eines API-Aufrufs zugreifen können. Die APIs, die wir verwenden, liefern als Rückgabe einen JSON-String.</p>
<p>JSON-Objekte sehen in etwa so aus: <code>{"attribut": "wert"}</code>. Während der Attributname stets ein String ist, kann der Wert ein <code>"String"</code>, eine Zahl, ein <code>[Array]</code>, ein <code>{Unterobjekt}</code>, usw. sein.</p>
<p>Normalerweise verwendet man eine spezielle <code>org.json</code>-Bibliothek, um in Java JSON-Daten zu verarbeiten. Das Hinzufügen von Bibliotheken behandeln wir jedoch erst später. Daher wird hier ein (nicht empfohlener!!!) Weg, einen JSON-String zu parsen verwendet, und zwar mittels der Nashorn-Engine. Diese wird jedoch in zuküftigen Java-Versionen entfernt.</p>
<p>Das Parsen eines JSON-Strings erfolgt in der Methode <code>APIHelper.parseJson</code>. Dort können zwei Dinge schief gehen: Wenn der übergebene String kein wohlgeformtes JSON ist, wird eine <code>javax.script.ScriptException</code> geworfen. Handelt es sich um kein JSON-Objekt, sondern zum Beispiel um einen Array, tritt eine <code>java.lang.ClassCastException</code> auf, weil das Casten auf die Klasse <code>Map</code> fehlschlägt (mehr zu Maps später im Kapitel über Collections).</p>
<p><b>Fangen Sie in der Methode <code>parseJson</code> diese beiden Exceptions ab und werfen Sie eine <code>new IllegalArgumentException("Ungueltiges JSON-Objekt")</code>.</b></p>
<p>Die <code>IllegalArgumentsException</code> ist eine Subklasse von <code>RuntimeException</code>. Sie muss also nicht abgefangen werden und bedarf auch einer <code>throws</code>-Deklaration.</p>
<p><b>Probieren Sie im Anschluss in der <code>Main</code>-Klasse aus, was passiert, wenn Sie einen nicht-wohlgeformten JSON-String übergeben (vergessen Sie z. B. ein <code>"</code> oder eine <code>}</code>) oder wenn Sie einen Array <code>[1,3,3]</code> übergeben.</b></p>
</html>